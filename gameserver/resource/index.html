<!DOCTYPE html>
<html lang="en">

<head>
    <link rel="shortcut icon" href="/static/favicon.ico">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Index</title>
    <link rel="stylesheet" href="/static/css/login.css">
    <link rel="stylesheet" href="/static/css/game.css">
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script src="http://www.w3schools.com/lib/w3data.js"></script>
</head>

<body>
    <div id="mydiv">
        <div id="log">Login</div>
        <div id="reg">Register</div>
        <div id="login-form" class="form-grp">
            <label>username/e-mail</label><br />
            <input id='input-name' class="input-grp" type='text' placeholder='type username' name='username' /><br />
            <label>password</label><br />
            <input id='input-password' class="input-grp" type='password' placeholder='*************'
                name='password' /><br />
            <button id='login-btn' class="input-btn">Login</button>
            <p><a id='forget-password' href='#'>forget password ?</a></p><br />
        </div>
        <form id="register-form" class="form-grp" action="register" method="POST">
            <label>username</label><br />
            <input class="input-grp" type='text' placeholder='user name' name='username' /><br />
            <label>e-mail</label><br />
            <input class="input-grp" type='email' placeholder='your email' name='email' /><br />
            <label>password</label><br />
            <input class="input-grp" type='password' placeholder='*************' name='password' /><br />
            <label>confirm password</label><br />
            <input class="input-grp" type='password' placeholder='*************' /><br />
            <input id='reg-btn' class="input-btn" type='submit' value='Register' />
        </form>
    </div>
    <script>
        let div = document.getElementById('mydiv'),
            log = document.getElementById('log'),
            reg = document.getElementById('reg'),
            loginForm = document.getElementById('login-form'),
            registerForm = document.getElementById('register-form'),
            login_btn = document.getElementById('login-btn');

        let token;            

        // hide register form and show login form
        reg.onclick = function () {
            this.style.color = '#fff';
            log.style.color = '#888';
            loginForm.style.display = 'none';
            registerForm.style.display = 'block';
        };

        // hide login form and show register form
        log.onclick = function () {
            this.style.color = '#fff';
            reg.style.color = '#888';
            loginForm.style.display = 'block';
            registerForm.style.display = 'none';
        };
        registerForm.style.display = 'none';

        //btn behaviors
        login_btn.onclick = function () {
            // console.log("login");
            let name = document.getElementById('input-name').value;
            let password = document.getElementById('input-password').value;
            let member = { username: name, password: password };

            axios({
                method: 'post',
                url: '/login',
                data: member
            })
            .then(function (response) {
                console.log('Success:', response)
                token = response.data;                
                let body = document.getElementsByTagName("body")[0];
                body.innerHTML = '<div w3-include-html="/static/game.html"></div>';
                w3IncludeHTML();                    
                let script = document.createElement('script');
                // script.onload = function () {
                //     alert("Script loaded and ready");
                // };
                script.src = "/static/js/handler.js";
                document.getElementsByTagName('head')[0].appendChild(script);
            })
            .catch(error => console.error('Error:', error));
        }
    </script>
</body>

</html>